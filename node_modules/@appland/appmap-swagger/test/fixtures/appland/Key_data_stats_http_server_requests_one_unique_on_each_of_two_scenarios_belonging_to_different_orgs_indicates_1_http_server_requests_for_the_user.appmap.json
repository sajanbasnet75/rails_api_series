{"version":"1.4","metadata":{"app":"appland/AppLand","language":{"name":"ruby","engine":"ruby","version":"2.6.6"},"client":{"name":"appmap","url":"https://github.com/applandinc/appmap-ruby","version":"0.40.0"},"frameworks":[{"name":"rails","version":"5.2.4.2"},{"name":"rspec","version":"3.9.1"}],"git":{"repository":"git@github.com:applandinc/appland.git","branch":"apply-labels","commit":"5428f5df16a93d59a15d2559c626f6918d8f0523","status":["M app/controllers/api/scenarios_controller.rb","M app/controllers/sessions_controller.rb","M appmap.yml"],"git_last_annotated_tag":null,"git_last_tag":"v0.17.1","git_commits_since_last_annotated_tag":null,"git_commits_since_last_tag":0},"name":"Key data stats http_server_requests one unique on each of two scenarios belonging to different orgs indicates 1 http_server_requests for the user","feature":"Key data stats http_server_requests","feature_group":"Key data stats","labels":["stats"],"recorder":{"name":"rspec"}},"classMap":[{"name":"app/models","type":"package","children":[{"name":"KeyDataStats","type":"class","children":[{"name":"count","type":"function","location":"app/models/key_data_stats.rb:11","static":true}]},{"name":"DAO","type":"class","children":[{"name":"Scenario","type":"class","children":[{"name":"http_server_requests_dataset","type":"function","location":"app/models/dao/scenario.rb:119","static":true}]}]}]}],"events":[{"id":51535,"event":"call","thread_id":70323680821280,"defined_class":"KeyDataStats","method_id":"count","path":"app/models/key_data_stats.rb","lineno":11,"static":true,"parameters":[{"name":"owner_type","class":"Symbol","object_id":945948,"value":"user","kind":"req"},{"name":"owner_id","class":"Integer","object_id":31,"value":"15","kind":"req"},{"name":"key_data_type","class":"Symbol","object_id":12100508,"value":"http_server_request","kind":"req"}],"receiver":{"class":"Module","object_id":70323683984920,"value":"KeyDataStats"}},{"id":51536,"event":"call","thread_id":70323680821280,"defined_class":"DAO::Scenario","method_id":"http_server_requests_dataset","path":"app/models/dao/scenario.rb","lineno":119,"static":true,"parameters":[{"name":"additional_tables","class":"Array","object_id":70323683957700,"value":"[:users_orgs]","kind":"key"}],"receiver":{"class":"Class","object_id":70323694585900,"value":"DAO::Scenario"}},{"id":51537,"event":"return","thread_id":70323680821280,"parent_id":51536,"elapsed":5.5e-05,"return_value":{"class":"Sequel::Postgres::Dataset","value":"#<Sequel::Postgres::Dataset:0x00007feb046708f8>","object_id":70323683951740}},{"id":51538,"event":"call","thread_id":70323680821280,"sql_query":{"sql":"WITH \"key_data_stats\" AS (SELECT DISTINCT http_server_request.http_server_request ->> 'request_method'::text AS \"request_method\", http_server_request.http_server_request ->> 'normalized_path_info'::text AS \"path_info\" FROM \"users_orgs\", \"scenarios\", LATERAL jsonb_to_recordset(COALESCE(scenarios.events_http_server_requests, '[]'::jsonb)) http_server_request(id integer, http_server_request jsonb) WHERE ((\"scenarios\".\"org_id\" = \"users_orgs\".\"org_id\") AND (\"user_id\" = 15))) SELECT count(*) AS \"num_distinct\" FROM \"key_data_stats\" LIMIT 1","database_type":"postgres","server_version":120003}},{"id":51539,"event":"return","thread_id":70323680821280,"parent_id":51538,"elapsed":0.001209},{"id":51540,"event":"return","thread_id":70323680821280,"parent_id":51535,"elapsed":0.003824,"return_value":{"class":"KeyDataStats::KeyDataStatsCount","value":"#<struct KeyDataStats::KeyDataStatsCount owner_type=:user, owner_id=15, key_data_type=:http_server_r","object_id":70323775558180}}]}